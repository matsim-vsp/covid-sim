import{Y as n}from"./index-BHfbxoTU.js";import{M as d,d as c,a as u,b as h,P as p,n as v}from"./index-I29Ew9Pc.js";import{V as f}from"./default-WrRgop0X.js";const _={messages:{en:{"r-value-calculator":"R-Value Calculator",badpage:"That page not found, sorry!","base-r-value":"Base R Value","calculated-r-value":"Calculated R Value",remarks:"Remarks","older-calculators":"All Calculators:"},de:{"r-value-calculator":"R-Wert-Rechner",badpage:"Seite wurde nicht gefunden.","base-r-value":"Basis R-Wert","calculated-r-value":"Resultierender R-Wert",remarks:"Bemerkungen","older-calculators":"Alle Rechner:"}}},r=new d({html:!0,linkify:!0,typographer:!0}),m=c({name:"RCalculator",i18n:_,components:{VueSlider:f,Colophon:u},props:{},data(){return{calcId:"",yaml:{baseValue:0,optionGroups:{},additiveGroups:{},notes:[]},adjustedR:2.5,selectedBaseR:2.5,finalR:2.5,badPage:!1,oldCalculators:h,lookup:{},sliders:{},factors:{},additions:{}}},mounted(){this.buildPageForURL()},computed:{topDescription(){return this.yaml.description?r.render(this.yaml.description):""},optionGroups(){return Object.keys(this.yaml.optionGroups)},additiveGroups(){return Object.keys(this.yaml.additiveGroups)}},watch:{$route(){this.buildPageForURL()}},methods:{parseMarkdown(e){return r.render(e)},handleNewBaseValue(e){this.selectedBaseR=e,this.updateR()},async buildPageForURL(){this.badPage=!1,this.calcId=this.$route.params.rcalc;const e=this.$i18n.locale,t=p+`r-calculator/${this.calcId}.${e}.yaml`;let s="";try{s=await(await fetch(t)).text()}catch(a){console.error(a)}if(!s&&t.indexOf(".de.")>-1){console.warn("no",t,"falling back to .en.");const a=t.replace(".de.",".en.");console.log(a);try{s=await(await fetch(a)).text()}catch(i){console.error(i)}}if(!s){this.badPage=!0;return}this.yaml=n.parse(s),this.yaml.additiveGroups||(this.yaml.additiveGroups={}),this.buildUI(),this.updateR()},async handleButton(e){const t=this.sliders[e];this.factors[e]=t.value,this.updateR(),this.$forceUpdate()},async handleAdditiveButton(e){const t=this.sliders[e];this.additions[e]=t.value,this.updateR(),this.$forceUpdate()},updateR(){let e=3;this.yaml.baseValue?e=this.yaml.baseValue:this.yaml.baseValues&&(e=this.selectedBaseR);for(const t of Object.values(this.additions))e+=t;for(const t of Object.values(this.factors))e*=t;this.finalR=e,this.animateTowardNewRValue()},animateTowardNewRValue(){const e=this.finalR-this.adjustedR,t=this.adjustedR+e*.2;this.adjustedR=t,Math.abs(this.adjustedR-this.finalR)<.01?this.adjustedR=this.finalR:setTimeout(this.animateTowardNewRValue,16)},buildUI(){this.yaml.baseValues&&(this.selectedBaseR=Object.values(this.yaml.baseValues[0])[0]);for(const e of Object.keys(this.yaml.optionGroups)){const t=this.yaml.optionGroups[e];this.lookup[e]=[];for(const s of t){const a=Object.keys(s)[0],i=s[a];if(!isNaN(i))this.lookup[e].push({title:a,value:i}),this.yaml.optionGroups[e]===void 0&&(this.factors[e]=i,this.sliders[e]=this.lookup[e][0]);else{const o=parseFloat(i.substring(0,i.length-1)),l={title:a,value:o};this.lookup[e].push(l),this.sliders[e]=l,this.factors[e]=o}}}for(const e of Object.keys(this.yaml.additiveGroups)){const t=this.yaml.additiveGroups[e];this.lookup[e]=[];for(const s of t){const a=Object.keys(s)[0],i=s[a];if(!isNaN(i))this.lookup[e].push({title:a,value:i}),this.yaml.additiveGroups[e]===void 0&&(this.additions[e]=i,this.sliders[e]=this.lookup[e][0]);else{const o=parseFloat(i.substring(0,i.length-1)),l={title:a,value:o};this.lookup[e].push(l),this.sliders[e]=l,this.additions[e]=o}}}}}});var b=function(){var t=this,s=t._self._c;return t._self._setupProxy,s("div",{staticClass:"r-caoculator"},[t._m(0),s("div",{staticClass:"page-area"},[s("colophon",{staticClass:"colophon"}),t.yaml.optionGroups?s("div",{staticClass:"r-calculator"},[s("h2",[t._v(t._s(t.$t("r-value-calculator")))]),s("h3",{style:{marginBottom:"1rem",color:"#596"}},[t._v(t._s(this.calcId))]),t.badPage?s("h3",{staticClass:"badpage"},[t._v(t._s(t.$t("badpage")))]):s("div",{staticClass:"goodpage"},[t.yaml.description?s("p",{domProps:{innerHTML:t._s(t.topDescription)}}):t._e(),s("div",{staticClass:"columns"},[s("div",{staticClass:"column"},[s("h3",[s("b",[t._v(t._s(t.$t("base-r-value"))+":  ")])]),s("h3",{staticClass:"greenbig"},[t._v(t._s((t.selectedBaseR*.9).toFixed(2))+" – "+t._s((t.selectedBaseR*1.1).toFixed(2)))]),t.yaml.baseValues?s("div",{staticClass:"base-buttons"},t._l(t.yaml.baseValues,function(a){return s("button",{staticClass:"button is-small",class:{active:t.selectedBaseR==Object.values(a)[0],"is-link":t.selectedBaseR==Object.values(a)[0]},on:{click:function(i){t.handleNewBaseValue(Object.values(a)[0])}}},[t._v(t._s(Object.keys(a)[0]))])}),0):t._e(),s("h3",[s("b",[t._v(t._s(t.$t("calculated-r-value"))+":")])]),s("h3",{staticClass:"greenbig",style:{fontSize:"2.5rem",fontWeight:"bold",color:"#596"}},[t._v(t._s((t.adjustedR*.9).toFixed(2))+" – "+t._s((t.adjustedR*1.1).toFixed(2)))])]),s("div",{staticClass:"column stretch"},[s("div",{staticClass:"option-groups"},[t._l(t.additiveGroups,function(a){return s("div",{key:`add+${a}`,staticClass:"option-group"},[s("h4",[t._v(t._s(a)),t.additions[a]!=0?s("span",{style:{fontWeight:"normal"}},[t._v("  : "+t._s(t.additions[a]>0?"+":"")+t._s(t.additions[a].toFixed(3)))]):t._e()]),s("vue-slider",{staticClass:"slider",attrs:{data:t.lookup[a],"data-value":"value","data-label":"title",tooltip:"none",adsorb:!0,dotSize:20},on:{change:function(i){return t.handleAdditiveButton(a)}},model:{value:t.sliders[a],callback:function(i){t.$set(t.sliders,a,i)},expression:"sliders[measure]"}}),s("p",{staticClass:"slider-label"},[t._v(t._s(t.sliders[a].title))])],1)}),t._l(t.optionGroups,function(a){return s("div",{key:a,staticClass:"option-group"},[s("h4",[t._v(t._s(a)),t.factors[a]!=1?s("span",{style:{fontWeight:"normal"}},[t._v("  : "+t._s(t.factors[a].toFixed(2))+"x")]):t._e()]),s("vue-slider",{staticClass:"slider",attrs:{data:t.lookup[a],"data-value":"value","data-label":"title",tooltip:"none",adsorb:!0,dotSize:20},on:{change:function(i){return t.handleButton(a)}},model:{value:t.sliders[a],callback:function(i){t.$set(t.sliders,a,i)},expression:"sliders[measure]"}}),s("p",{staticClass:"slider-label"},[t._v(t._s(t.sliders[a].title))])],1)})],2)])]),s("br"),t.yaml.notes?s("h3",[s("b",[t._v(t._s(t.$t("remarks"))+":")])]):t._e(),t.yaml.notes?s("ul",t._l(t.yaml.notes,function(a){return s("li",{staticClass:"notes-item",domProps:{innerHTML:t._s(t.parseMarkdown(a))}})}),0):t._e(),s("h3",[s("b",[t._v(t._s(t.$t("older-calculators"))+":")])]),t.oldCalculators?s("ul",t._l(t.oldCalculators,function(a){return s("li",{staticClass:"notes-item"},[s("router-link",{attrs:{to:a.url}},[t._v(t._s(a.title)+", "+t._s(a.date))])],1)}),0):t._e()])]):t._e()],1)])},y=[function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"banner"},[t("h2",[e._v("VSP / Technische Universität Berlin")]),t("h3",[e._v("COVID-19 Analysis Portal")])])}],R=v(m,b,y,!1,null,"65710d7b");const j=R.exports;export{j as default};
//# sourceMappingURL=RCalculator-GDpgzbh8.js.map
