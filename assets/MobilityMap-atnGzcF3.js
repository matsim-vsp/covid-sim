import{d as l,n as d}from"./index-B2iCMRv8.js";import{V as c}from"./VuePlotly-OILT5ZMO.js";const u=l({name:"MobilityPlot",components:{VuePlotly:c},props:{data:{type:Array,required:!0},outOfHomeDurationPlot:{type:Boolean,required:!0},yAxisName:{type:String,required:!0},plotInterval:{type:Array,required:!0},activity:{type:String,required:!0},time:{type:String,required:!0},loadPage:{type:String,required:!0}},data(){return{dataLines:[],layout:{showlegend:!0,autosize:!0,legend:{orientation:"h"},font:{family:"Roboto,Arial,Helvetica,sans-serif",size:12,color:"#000"},margin:{t:5,r:60,b:0,l:60},xaxis:{fixedrange:window.innerWidth<700,type:"date"},yaxis:{fixedrange:window.innerWidth<700,type:"linear",autorange:!0,title:this.yAxisName},plot_bgcolor:"#f8f8f8",paper_bgcolor:"#f8f8f8"},options:{responsive:!0,displaylogo:!1,modeBarButtonsToRemove:["pan2d","zoom2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","resetScale2d","toggleSpikelines","resetViewMapbox"],toImageButtonOptions:{format:"svg",filename:"custom_image",width:1200,height:600,scale:1}}}},mounted(){this.updateMobilityData()},watch:{activity(){this.layout.yaxis.title=this.yAxisName,this.updateMobilityData()},data(){this.updateMobilityData()},loadPage(){this.updateMobilityData()}},methods:{updateMobilityData(){var e=[],t=this.activity;this.outOfHomeDurationPlot||(t="percentageChangeComparedToBeforeCorona");for(const[s,i]of Object.entries(this.data)){var a=[],o=[];const r=s;for(const[p,n]of Object.entries(i))p==this.time&&(a=Object.keys(n),a.forEach(h=>{o.push(n[h][t])}));r=="Deutschland"?e.push({name:r,x:a,y:o,fill:"none",marker:{size:4},line:{dash:"line",width:2,color:"black"}}):e.push({name:r,x:a,y:o,fill:"none",marker:{size:2},opacity:"0.5",line:{dash:"dot",width:1.5,color:r}})}this.dataLines=e}}});var m=function(){var t=this,a=t._self._c;return t._self._setupProxy,a("vue-plotly",{attrs:{data:t.dataLines,layout:t.layout,options:t.options}})},y=[],g=d(u,m,y,!1,null,"46212465");const M=g.exports,f="pk.eyJ1IjoidnNwLXR1LWJlcmxpbiIsImEiOiJjamNpemh1bmEzNmF0MndudHI5aGFmeXpoIn0.u9f04rjFo7ZbWiSceTTXyA",v=l({name:"CollapsiblePanel",components:{VuePlotly:c},props:{landkreisData:{type:Array,required:!0},startDate:{type:String,required:!0},endDate:{type:String,required:!0},time:{type:String,required:!0},activity:{type:String,required:!0},mapping:{type:Object}},data(){const e=[[0,"rgb(20,137,73)"],[.5,"rgb(243,240,159)"],[1,"rgb(200,32,38)"]];return{jsonData:{},test:"",landkreiseUrl:"/landkreise-in-germany.geojson",bundeslandUrl:"/Bundesländer_2016_ew.json",svnUrl:"https://svn.vsp.tu-berlin.de/repos/public-svn/matsim/scenarios/countries/de/episim/original-data/landkreise-in-germany",logColorScale:e,data:[{type:"choroplethmapbox",locations:["a","b"],featureidkey:"",z:[1,2],geojson:[],text:["a","b"],zmin:-40,zmax:40,colorscale:e,hoverinfo:"ztext",colorbar:{title:{text:"Percentage change",side:"right",font:{size:15}}}}],layout:{mapbox:{center:{lon:10.3,lat:51.3},zoom:5.3,style:"basic"},margin:{t:5,r:0,b:0,l:0},paper_bgcolor:"rgb(236,239,242)",coloraxis:{cauto:!1,cmin:-5,cmax:5}},config:{mapboxAccessToken:f,toImageButtonOptions:{format:"svg",filename:"germany_mobility",width:800,height:900,scale:1}}}},mounted(){this.loadData(this.svnUrl+this.landkreiseUrl),this.updateMap()},watch:{mapping(){this.updateMap()},activity(){this.updateMap()},startDate(){this.updateMap()},endDate(){this.updateMap()},time(){this.updateMap()},landkreisData(){this.updateMap()}},methods:{handleClick(e){try{const t=e.points[0].location;console.log("User clicked on:",t),this.$emit("landkreisClicked",t)}catch(t){console.error(t)}},async loadData(e){const a=await(await fetch("https://svn.vsp.tu-berlin.de/repos/public-svn/matsim/scenarios/countries/de/episim/original-data/landkreise-in-germany/landkreise-in-germany.geojson")).json();this.data[0].geojson=a},async loadBundesland(e){const a=await(await fetch("https://svn.vsp.tu-berlin.de/repos/public-svn/matsim/scenarios/countries/de/episim/original-data/landkreise-in-germany/Bundesländer_2016_ew.json")).json();this.data[1].geojson=a},updateMap(){if(this.mapping!==void 0){var e=[],t=[],a=[];for(const[s,i]of Object.entries(this.landkreisData)){var o;o=this.mapping[s],e.push(o),a.push(s),i[this.time][this.endDate]===void 0||i[this.time][this.startDate]===void 0||(this.startDate==this.endDate?(t.push(i[this.time][this.endDate][this.activity]),this.data[0].zmin=0,this.data[0].zmax=0,this.data[0].colorscale=[["ylorbr"]],this.activity=="endHomeActs"?this.data[0].colorbar.title.text="Per day of out-of-home activity between 10 p.m. and 5 a.m. per 1,000 inhabitants":this.activity=="sharePersonLeavingHome"?this.data[0].colorbar.title.text="Percent [%]":this.activity=="dailyRangePerPerson"?this.data[0].colorbar.title.text="Distance per Person [km]":this.activity=="outOfHomeDuration"&&(this.data[0].colorbar.title.text="Time per Day [h]")):(t.push(i[this.time][this.endDate][this.activity]*(100/i[this.time][this.startDate][this.activity])-100),this.data[0].colorscale=this.logColorScale,this.data[0].zmin=-40,this.data[0].zmax=40,this.data[0].colorbar.title.text="Percentage change [%]"),this.data[0].locations=e,this.data[0].z=t,this.data[0].featureidkey="properties.id_2",this.data[0].text=a,this.data=[...this.data])}}else console.log("Mapping not defined")}}});var b=function(){var t=this,a=t._self._c;return t._self._setupProxy,a("vue-plotly",{attrs:{data:t.data,layout:t.layout,options:t.config},on:{click:t.handleClick}})},_=[],x=d(v,b,_,!1,null,"3fc6d9c7");const j=x.exports;export{M,j as a};
//# sourceMappingURL=MobilityMap-atnGzcF3.js.map
